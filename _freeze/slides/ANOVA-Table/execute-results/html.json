{
  "hash": "ce6aabb2a02e2396bca14555c27e283f",
  "result": {
    "markdown": "---\ntitle: Understanding ANOVA output\n---\n\n\nWe will use the Tips data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(patchwork)\nlibrary(knitr)\nlibrary(kableExtra)\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n::: {.cell messag='false'}\n::: {.cell-output .cell-output-stderr}\n```\nRows: 422 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): Day, Meal, Payment, Age, GiftCard, Comps, Alcohol, Bday\ndbl (5): Party, Bill, W/Tip, Tip, Tip Percentage\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nThe variables of interest in this analysis are\n\n-   `Party`: Number of people in the party\n-   `Meal`: Time of day (Lunch, Dinner, Late Night)\n-   `Age`: Age category of person paying the bill (Yadult, Middle, SenCit)\n\n## Model fit\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntip_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(Tip ~ Party + Age, data = tips)\n\ntidy(tip_fit) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.170 </td>\n   <td style=\"text-align:right;\"> 0.366 </td>\n   <td style=\"text-align:right;\"> -0.465 </td>\n   <td style=\"text-align:right;\"> 0.643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Party </td>\n   <td style=\"text-align:right;\"> 1.837 </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 14.758 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AgeMiddle </td>\n   <td style=\"text-align:right;\"> 1.009 </td>\n   <td style=\"text-align:right;\"> 0.408 </td>\n   <td style=\"text-align:right;\"> 2.475 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AgeSenCit </td>\n   <td style=\"text-align:right;\"> 1.388 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n   <td style=\"text-align:right;\"> 2.862 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(tip_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> sumsq </th>\n   <th style=\"text-align:right;\"> meansq </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Party </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1188.64 </td>\n   <td style=\"text-align:right;\"> 1188.64 </td>\n   <td style=\"text-align:right;\"> 285.71 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Age </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 38.03 </td>\n   <td style=\"text-align:right;\"> 19.01 </td>\n   <td style=\"text-align:right;\"> 4.57 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:right;\"> 165 </td>\n   <td style=\"text-align:right;\"> 686.44 </td>\n   <td style=\"text-align:right;\"> 4.16 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Parts of the ANOVA table\n\nR uses a sequential method to calculate sum of squares for the variables in the model. In other words, the sum of squares attributed to each variable is the sum of squares after accounting for the other variables already in the model. The order of the sequence is determined by the order of the variables in the model fit code. It is also reflected in the order the variables appear in the ANOVA output.\n\nSo let's take a look at the sum of squares for `Party`, the first variable in the model. This value is calculated as the total variation in `Tips` accounted for by `Party`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparty_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(Tip ~ Party, data = tips)\n\nanova(party_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> sumsq </th>\n   <th style=\"text-align:right;\"> meansq </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Party </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1188.64 </td>\n   <td style=\"text-align:right;\"> 1188.64 </td>\n   <td style=\"text-align:right;\"> 274 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 724.47 </td>\n   <td style=\"text-align:right;\"> 4.34 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nNext, let's add `Age` to the model. The sum of squares associated with `Age` is the total variation in `Tips` accounted for by `Age` after accounting for variation explained by `Party`. In other words, it is the additional model variation in the model with `Party` and `Age` compared to a model that only includes `Party`. We can calculate this additional variation as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(party_fit$fit, tip_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> rss </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> sumsq </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Tip ~ Party </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 724.47 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tip ~ Party + Age </td>\n   <td style=\"text-align:right;\"> 165 </td>\n   <td style=\"text-align:right;\"> 686.44 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 38.03 </td>\n   <td style=\"text-align:right;\"> 4.57 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: callout-note\nWhen we input two model is the `anova()` function, e.g., `anova(Model 1, Model 2)`, the output produced is the sum of squares accounted for by the new variable(s) in `Model 2` after accounting for the variables in `Model 1`. In this case, it is the additional sum of squares accounted for by `Age` after accounting for `Party`.\n:::\n",
    "supporting": [
      "ANOVA-Table_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}